# Specification (Design from Design and Implementation)

## Architectural Design
![Arch](../assets/scheduling%20logic%20explanation.drawio.png)

# Specification explanation
The above diagram is a pictorial representation of how we are calculating available slots.

### Pseudo form
1. The total slots are generated from a work shift. This shift is generated by a registered 
 specified range of hours. We generate hours from that range
2. Next step is to remove all the hours which are not available for several differen reasons.
   1. Lunch Hour - The defined fixed hour 
   2. Booked Schedule Hours - The hours which are already booked in some other appointment
   3. Reserved Slots for priority booking - The slots which are available for booking for prior patients. 
      They are free for booking once 7 days passes.
   4. Available slots joined with Doctor_info, specialization, illness mapping - This part filters the doctor for specialization and illness category which are arguments 
    passed from the app. 

### ER Diagram 
The ER diagram shows all tables and relations for all DB objects in the database.
There's a also a unconnected history table which stores all the past schedule of a doctor and is populated 
at the end of the day.

![ER diagram](../assets/2021-12-15_21-12.png)


# How is 14 days limit is ensured.
We introduced a concept of priority, which says a time slot can be potentially booked by a patient which is put in for some priority for a particular slot for a doctor.
This priority is then considered to show available slots to the all the patients except those potential slots.
Until 7 days futher from current_date, the priority slots are available to be booked by only prior patients only.
In case the priority slot is not booked in 7 days, the slot opens up for all the patient to book.